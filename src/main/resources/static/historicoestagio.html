<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Histórico e Acompanhamento de Estágio - SIGE</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-blue-50 min-h-screen p-6">

  <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-lg p-6">

    <h2 class="text-3xl font-bold text-center mb-6 text-gray-800">
      Histórico e Acompanhamento do Estágio
    </h2>

    <!-- Filtro de Situação Final -->
    <div class="mb-4">
      <label for="filtroSituacao" class="mr-2 font-semibold">Filtrar por Situação:</label>
      <select id="filtroSituacao" class="border px-2 py-1 rounded">
        <option value="">Todas</option>
        <option value="Concluído">Concluído</option>
        <option value="Em andamento">Em andamento</option>
        <option value="Cancelado">Cancelado</option>
      </select>
    </div>

    <!-- Tabela do Histórico -->
    <table class="min-w-full border border-gray-300 text-sm">
      <thead class="bg-blue-100 text-gray-800">
        <tr>
          <th class="px-3 py-2 border">Empresa</th>
          <th class="px-3 py-2 border">Período</th>
          <th class="px-3 py-2 border">Atividades</th>
          <th class="px-3 py-2 border">Tarefas</th>
          <th class="px-3 py-2 border">Avaliação</th>
          <th class="px-3 py-2 border">Horas Cumpridas</th>
          <th class="px-3 py-2 border">Documentos</th>
          <th class="px-3 py-2 border">Status Geral</th>
          <th class="px-3 py-2 border">Situação Final</th>
        </tr>
      </thead>

      <tbody id="historico-body" class="text-gray-700">
        <!-- Dados inseridos via JavaScript -->
      </tbody>

      <tfoot>
        <tr class="font-bold bg-blue-50">
          <td colspan="5" class="px-3 py-2 border text-right">Total de Horas:</td>
          <td id="total-horas" class="px-3 py-2 border text-center">0h</td>
          <td colspan="3" class="border"></td>
        </tr>
      </tfoot>
    </table>

    <!-- Botão para voltar à dashboard -->
    <div class="text-center mt-6">
      <button 
        class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
        onclick="window.location.href='/dashboardaluno.html'">
        Voltar para Dashboard
      </button>
    </div>

  </div>

  <script>
    // Dados simulados para o aluno
    const todosEstagios = [
      {
        empresa: "Empresa A",
        periodo: "Jan 2025 - Jun 2025",
        atividades: "Aprender a desenvolver sistemas internos",
        tarefas: "Documentar processos, implementar funcionalidades",
        avaliacao: "Excelente",
        horas_cumpridas: 200,
        documentos: "Aprovados",
        status: "ATIVO",
        status_geral: "Em dia",
        situacao_final: "Concluído"
      },
      {
        empresa: "Empresa B",
        periodo: "Jul 2025 - Dez 2025",
        atividades: "Estudar processos administrativos",
        tarefas: "Organizar planilhas, auxiliar equipe",
        avaliacao: "Bom",
        horas_cumpridas: 150,
        documentos: "Pendentes",
        status: "ATIVO",
        status_geral: "Atenção",
        situacao_final: "Em andamento"
      },
      {
        empresa: "Empresa C",
        periodo: "Jan 2024 - Dez 2024",
        atividades: "Simulação de atendimento ao cliente",
        tarefas: "Registrar feedbacks, criar relatórios",
        avaliacao: "Regular",
        horas_cumpridas: 180,
        documentos: "Aprovados",
        status: "FINALIZADO",
        status_geral: "Em dia",
        situacao_final: "Concluído"
      }
    ];

    // Funções de cores
    function corStatus(status) {
      if(status === 'Em dia') return 'text-green-700';
      if(status === 'Atenção') return 'text-yellow-600';
      if(status === 'Atrasado') return 'text-red-600';
      return '';
    }

    function corSituacao(situacao) {
      if(situacao === 'Concluído') return 'text-green-700';
      if(situacao === 'Em andamento') return 'text-yellow-600';
      if(situacao === 'Cancelado') return 'text-red-600';
      return '';
    }

    // Atualiza a tabela
    function atualizarTabela(estagios) {
      const body = document.getElementById("historico-body");
      body.innerHTML = "";

      let totalHoras = 0;

      estagios.forEach(estagio => {
        totalHoras += estagio.horas_cumpridas || 0;

        body.innerHTML += `
          <tr class="hover:bg-blue-50">
            <td class="border px-2 py-2">${estagio.empresa}</td>
            <td class="border px-2 py-2">${estagio.periodo}</td>
            <td class="border px-2 py-2">${estagio.atividades}</td>
            <td class="border px-2 py-2">${estagio.tarefas}</td>
            <td class="border px-2 py-2">${estagio.avaliacao}</td>
            <td class="border px-2 py-2 text-center">${estagio.horas_cumpridas}h</td>
            <td class="border px-2 py-2 font-semibold">${estagio.documentos}</td>
            <td class="border px-2 py-2 font-semibold ${corStatus(estagio.status_geral)}">${estagio.status_geral}</td>
            <td class="border px-2 py-2 font-semibold ${corSituacao(estagio.situacao_final)}">${estagio.situacao_final}</td>
          </tr>
        `;
      });

      document.getElementById("total-horas").textContent = totalHoras + 'h';
    }

    // Inicializa a tabela com dados simulados
    atualizarTabela(todosEstagios);

    // Evento do filtro
    document.getElementById("filtroSituacao").addEventListener("change", (e) => {
      const situacao = e.target.value;
      if (!situacao) {
        atualizarTabela(todosEstagios);
      } else {
        const filtrados = todosEstagios.filter(est => est.situacao_final === situacao);
        atualizarTabela(filtrados);
      }
    });
  </script>

</body>
</html>
